<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://icyfe.github.io/icyblog/</id>
    <title>icyfe</title>
    <updated>2020-07-29T02:32:00.668Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://icyfe.github.io/icyblog/"/>
    <link rel="self" href="https://icyfe.github.io/icyblog/atom.xml"/>
    <subtitle>å¥½å¥½å­¦ä¹ å¤©å¤©å‘ä¸ŠğŸŒ¸</subtitle>
    <logo>https://icyfe.github.io/icyblog/images/avatar.png</logo>
    <icon>https://icyfe.github.io/icyblog/favicon.ico</icon>
    <rights>All rights reserved 2020, icyfe</rights>
    <entry>
        <title type="html"><![CDATA[Electron è¸©å‘è®°å½•]]></title>
        <id>https://icyfe.github.io/icyblog/post/electron-cai-keng-ji-lu/</id>
        <link href="https://icyfe.github.io/icyblog/post/electron-cai-keng-ji-lu/">
        </link>
        <updated>2020-07-29T02:27:04.000Z</updated>
        <content type="html"><![CDATA[<h2 id="1-vuecli3-electron-ä½¿ç”¨cæ‰©å±•nodeæ–‡ä»¶åŠ è½½å¤±è´¥é—®é¢˜">1ã€ vuecli3 electron ä½¿ç”¨c++æ‰©å±•.nodeæ–‡ä»¶åŠ è½½å¤±è´¥é—®é¢˜</h2>
<figure data-type="image" tabindex="1"><img src="https://icyfe.github.io/icyblog//post-images/1595989722298.png" alt="" loading="lazy"></figure>
<h3 id="è§£å†³">è§£å†³</h3>
<p>å†vue.config.jsä¸­é…ç½®</p>
<pre><code class="language-js">module.exports = {
    pluginOptions: {
        electronBuilder: {
            chainWebpackMainProcess: config =&gt; {
                config.module.rule('node').test(/\.node$/).use('node-loader').loader('node-loader').end()
            },
        }
    }
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeQ61:æ—‹è½¬é“¾è¡¨]]></title>
        <id>https://icyfe.github.io/icyblog/post/leetcodeq61xuan-zhuan-lian-biao/</id>
        <link href="https://icyfe.github.io/icyblog/post/leetcodeq61xuan-zhuan-lian-biao/">
        </link>
        <updated>2020-06-24T06:58:01.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®ç»™å®šä¸€ä¸ªé“¾è¡¨æ—‹è½¬é“¾è¡¨å°†é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹å‘å³ç§»åŠ¨-k-ä¸ªä½ç½®å…¶ä¸­-k-æ˜¯éè´Ÿæ•°">é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œæ—‹è½¬é“¾è¡¨ï¼Œå°†é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹å‘å³ç§»åŠ¨Â kÂ ä¸ªä½ç½®ï¼Œå…¶ä¸­Â kÂ æ˜¯éè´Ÿæ•°ã€‚</h2>
<p>ç¤ºä¾‹Â 1:</p>
<p>è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL, k = 2<br>
è¾“å‡º: 4-&gt;5-&gt;1-&gt;2-&gt;3-&gt;NULL<br>
è§£é‡Š:<br>
å‘å³æ—‹è½¬ 1 æ­¥: 5-&gt;1-&gt;2-&gt;3-&gt;4-&gt;NULL<br>
å‘å³æ—‹è½¬ 2 æ­¥: 4-&gt;5-&gt;1-&gt;2-&gt;3-&gt;NULL<br>
ç¤ºä¾‹Â 2:</p>
<p>è¾“å…¥: 0-&gt;1-&gt;2-&gt;NULL, k = 4<br>
è¾“å‡º: 2-&gt;0-&gt;1-&gt;NULL<br>
è§£é‡Š:<br>
å‘å³æ—‹è½¬ 1 æ­¥: 2-&gt;0-&gt;1-&gt;NULL<br>
å‘å³æ—‹è½¬ 2 æ­¥: 1-&gt;2-&gt;0-&gt;NULL<br>
å‘å³æ—‹è½¬ 3 æ­¥:Â 0-&gt;1-&gt;2-&gt;NULL<br>
å‘å³æ—‹è½¬ 4 æ­¥:Â 2-&gt;0-&gt;1-&gt;NULL</p>
<h2 id="é¢˜è§£">é¢˜è§£ï¼š</h2>
<p>1ï¼šè®¡ç®—èŠ‚ç‚¹ä¸ªæ•°å¹¶æ‰¾åˆ°æ—§å°¾é“¾æ¥åˆ°æ–°å¤´å½¢æˆé—­ç¯<br>
2ï¼šä¸ºäº†æ‰¾åˆ°æ–°å°¾å·´çš„ä½ç½®æˆ‘ä»¬ç›´æ¥ç”¨n- k -1å³å¯ï¼Œé˜²æ­¢å‡ºç°k &gt;èŠ‚ç‚¹æ•°nçš„æƒ…å†µè®¡ç®—ç»“æœä¸ºè´Ÿæ•°ï¼Œåªè¦        k%nå°±å¯ä»¥å–å¾—æ­£ç¡®çš„å€¼ï¼Œå¾—åˆ°å…¬å¼ (n - k % n -1)   ï¼Œ<br>
3ï¼šæ–­å¼€æ–°å¤´æ–°å°¾å·´çš„é“¾æ¥ï¼Œ<br>
4ï¼šå¹¶å°†æ–°å°¾å·´çš„nextç½®ç©º</p>
<pre><code class="language-java"> public ListNode rotateRight(ListNode head, int k) {
       if (head == null) {
           return null;
       }
       if (head.next == null) {
           return head;
       }
       ListNode oldTail = head;
       // æ‰¾åˆ°æ—§å°¾å¹¶è®¡ç®—èŠ‚ç‚¹ä¸ªæ•°
       int n = 0;
       for (n = 1; oldTail.next != null; n++) {
           oldTail = oldTail.next;
       }
       oldTail.next = head; // æ—§å¤´æŒ‡å‘æ—§å¤´ å½¢æˆé—­ç¯
       ListNode newTail = head;
       // æ‰¾åˆ°æ–°å°¾ä½ç½®ä¹Ÿå°±æ˜¯æ–­å¼€é—­ç¯ä½ç½® n - K % 2 -1 å…¬å¼å¯æ‰¾åˆ°æ–°å°¾ä½ç½®
       for (int j = 0; j &lt; n - k % n - 1; j++) {
           newTail = newTail.next;
       }
       ListNode newHead = newTail.next; // æ–°å¤´ä½äºæ–°å°¾åé¢
       newTail.next = null; // æ–­å¼€é—­ç¯
       return newHead;
   }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeQ19:åˆ é™¤å€’æ•°ç¬¬nä¸ªèŠ‚ç‚¹]]></title>
        <id>https://icyfe.github.io/icyblog/post/leetcodeq19shan-chu-dao-shu-di-n-ge-jie-dian/</id>
        <link href="https://icyfe.github.io/icyblog/post/leetcodeq19shan-chu-dao-shu-di-n-ge-jie-dian/">
        </link>
        <updated>2020-06-23T06:55:58.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®ç»™å®šä¸€ä¸ªé“¾è¡¨åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬-n-ä¸ªèŠ‚ç‚¹å¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹">é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Â nÂ ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”è¿”å›é“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚</h2>
<p>ç¤ºä¾‹ï¼š<br>
ç»™å®šä¸€ä¸ªé“¾è¡¨: 1-&gt;2-&gt;3-&gt;4-&gt;5, å’Œ n = 2.<br>
å½“åˆ é™¤äº†å€’æ•°ç¬¬äºŒä¸ªèŠ‚ç‚¹åï¼Œé“¾è¡¨å˜ä¸º 1-&gt;2-&gt;3-&gt;5.</p>
<h2 id="é¢˜è§£">é¢˜è§£ï¼š</h2>
<p>åˆ©ç”¨å“‘ç»“ç‚¹å’ŒåŒæŒ‡é’ˆï¼Œè®©startæŒ‡é’ˆå…ˆç§»åŠ¨nä¸ªä½ç½®ï¼Œ ç„¶åä¸¤ä¸ªæŒ‡é’ˆå†ä¸€èµ·ç§»åŠ¨ï¼Œå½“startç§»åŠ¨çš„å·²ç»ä¸ºç©ºäº†è¯´æ˜å·²ç»åˆ°äº†è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ è®©endæŒ‡é’ˆæŒ‡å‘å®ƒçš„ä¸‹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å³å¯å®Œæˆåˆ é™¤</p>
<figure data-type="image" tabindex="1"><img src="https://pic.leetcode-cn.com/cc43daa8cbb755373ce4c5cd10c44066dc770a34a6d2913a52f8047cbf5e6e56-file_1559548337458" alt="" loading="lazy"></figure>
<pre><code class="language-java">public ListNode removeNthFromEnd(ListNode head, int n) {
        ListNode dh = new ListNode(0);
        dh.next = head;
        ListNode start = dh;
        ListNode end = dh;

        for (int i = 1; i &lt;= n + 1; i++) {
            start = start.next;
        }
        while (start != null) {
            start = start.next;
            end = end.next;
        }
        end.next = end.next.next;
        return dh.next;
    }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeQ2:ä¸¤æ•°ç›¸åŠ ]]></title>
        <id>https://icyfe.github.io/icyblog/post/leetcodeq2liang-shu-xiang-jia-lian-biao/</id>
        <link href="https://icyfe.github.io/icyblog/post/leetcodeq2liang-shu-xiang-jia-lian-biao/">
        </link>
        <updated>2020-06-22T04:19:18.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®ç»™å‡ºä¸¤ä¸ª-éç©º-çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°-å…¶ä¸­å®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§-é€†åº-çš„æ–¹å¼å­˜å‚¨çš„å¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨-ä¸€ä½-æ•°å­—">é¢˜ç›®:ç»™å‡ºä¸¤ä¸ªÂ éç©º çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å…¶ä¸­ï¼Œå®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§Â é€†åºÂ çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨Â ä¸€ä½Â æ•°å­—ã€‚</h2>
<p>å¦‚æœï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ•°ç›¸åŠ èµ·æ¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é“¾è¡¨æ¥è¡¨ç¤ºå®ƒä»¬çš„å’Œã€‚<br>
æ‚¨å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0Â å¼€å¤´ã€‚<br>
ç¤ºä¾‹ï¼š<br>
è¾“å…¥ï¼š(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>
è¾“å‡ºï¼š7 -&gt; 0 -&gt; 8<br>
åŸå› ï¼š342 + 465 = 807</p>
<h2 id="é¢˜è§£">é¢˜è§£ï¼š</h2>
<p>åˆ©ç”¨å“‘ç»“ç‚¹ï¼Œéå†ä¸¤ä¸ªé“¾è¡¨çš„å€¼ä½¿å…¶ä¸€ ä¸€ç›¸åŠ ï¼Œç”¨carryè®°å½•å½“å‰çš„å€¼æ˜¯å¦å¤§äº10ï¼› å¤§äº10ä¸‹ä¸€ä½å¦‚æœæœ‰å€¼ä¸ä¸ºç©ºåˆ™+1ï¼Œå¦‚æœä¸‹ä¸€ä½å€¼ä¸ºç©ºè¯´æ˜å·²ç»éå†å®Œæˆäº†ï¼Œåˆ™åœ¨æœ«å°¾åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å€¼ä¸º carryå€¼ï¼Œå½“å‰çš„ç›¸åŠ çš„å€¼ä¸º sum %10ã€‚</p>
<pre><code class="language-java">public ListNode twoSum(ListNode l1, ListNode l2) {
        ListNode dh = new ListNode(0);
        ListNode a = l1, b = l2, pre = dh;
        int carry = 0;
        while (a != null || b != null) {
            int x = (a != null) ? a.val : 0;
            int y = (b != null) ? b.val : 0;
            int sum = carry + x + y;

            carry = sum / 10;
            pre.next = new ListNode(sum % 10);
            pre = pre.next;
            if (a != null)
                a = a.next;
            if (b != null)
                b = b.next;

        }
        // éå†å®Œæˆï¼Œcarryä»ç„¶å¤§äº0åˆ™åœ¨æœ«å°¾åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å€¼ä¸ºå½“å‰çš„carryå€¼
        if (carry &gt; 0) {
            pre.next = new ListNode(carry);
        }
        return dh.next;
    }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCodeQ1ï¼šä¸¤æ•°ä¹‹å’Œ]]></title>
        <id>https://icyfe.github.io/icyblog/post/leetcodeq1liang-shu-zhi-he/</id>
        <link href="https://icyfe.github.io/icyblog/post/leetcodeq1liang-shu-zhi-he/">
        </link>
        <updated>2020-06-20T10:00:15.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„-nums-å’Œä¸€ä¸ªç›®æ ‡å€¼-targetè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£-ä¸¤ä¸ª-æ•´æ•°å¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡">é¢˜ç›®:ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsÂ å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£Â ä¸¤ä¸ªÂ æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</h2>
<p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚<br>
ç¤ºä¾‹:<br>
ç»™å®š nums = [2, 7, 11, 15], target = 9<br>
å› ä¸º nums[0] + nums[1] = 2 + 7 = 9<br>
æ‰€ä»¥è¿”å› [0, 1]</p>
<h2 id="è§£æ³•ä¸€">è§£æ³•ä¸€</h2>
<p>æš´åŠ›è§£æ³•ä¸¤ééå†æ‰¾å‡ºä¸¤æ•°ç›¸åŠ ç­‰äºtargetçš„ä¸¤ä¸ªvalçš„ä¸‹æ ‡å€¼</p>
<pre><code class="language-java">public int[] twoSum(int[] nums, int target) {
        int[] result = new int[2];
        for (int i = 0; i &lt; nums.length; i++) {
            for (int j = i + 1; j &lt; nums.length; j++) {
                if (nums[i] + nums[j] == target) {
                    result[0] = i;
                    result[1] = j;
                    return result;
                }
            }
        }
        return null;
}
</code></pre>
<h2 id="è§£æ³•äºŒ">è§£æ³•äºŒ</h2>
<p>ä¸€ééå†ï¼Œåˆ©ç”¨hashå­˜å‚¨æ¯ä¸ªå€¼ï¼Œç”¨target å‡å»å½“å‰éå†çš„å€¼å¾—åˆ°çš„ç»“æœæ˜¯å¦ å­˜åœ¨hashé‡Œï¼Œæœ‰çš„è¯è¿”å›ä¸¤ä¸ªå€¼çš„ä¸‹æ ‡</p>
<pre><code class="language-java"> public int[] twoSum(int[] a, int target) {
        Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;();
        for (int i = 0; i &lt; a.length; i++) {
            if (map.containsKey(target - a[i])) {
                return new int[] { map.get(target - a[i]), i };
            }
            map.put(a[i], i);
        }
        return null;
 }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ·±å…¥ç†è§£Cssæƒé‡å€¼]]></title>
        <id>https://icyfe.github.io/icyblog/post/shen-ru-li-jie-css-quan-chong-zhi/</id>
        <link href="https://icyfe.github.io/icyblog/post/shen-ru-li-jie-css-quan-chong-zhi/">
        </link>
        <updated>2020-05-12T14:36:35.000Z</updated>
        <content type="html"><![CDATA[<h1 id="css-æƒé‡å€¼">Css æƒé‡å€¼ï¼Ÿ</h1>
<p>åœ¨æ—¥å¸¸æˆ‘ä»¬å†™ css æ ·å¼çš„æ—¶å€™æˆ–å¤šæˆ–å°‘éƒ½é‡åˆ°è¿‡è‡ªå·±å†™çš„æ ·å¼ä¸ç”Ÿæ•ˆçš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä¸ä¼šå»æ¢ç©¶èƒŒåçš„åŸå› ç›´æ¥ä¸€è‚¡è„‘çš„ï¼important å®Œäº‹ï¼Œä½†è¿™æ ·æ˜¯éå¸¸ä¸å¥½çš„ï¼Œä½†æœ‰çš„æ—¶å€™åŠ äº† important ä¹Ÿæ— æ³•ç”Ÿæ•ˆæ ·å¼ï¼ˆå½“ç„¶æˆ‘ä»¬è¿˜æ˜¯éµå¾ªèƒ½ä¸å†™ Important å°±å°½é‡ä¸å†™ï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼åœ¨ css å†™æ ·å¼ä¸­æœ‰ä¸ªé‡è¦çš„æƒé‡é—®é¢˜ï¼</p>
<h2 id="ä»€ä¹ˆæ˜¯æƒé‡">ä»€ä¹ˆæ˜¯æƒé‡ï¼Ÿ</h2>
<p>æ¯ä¸ª css è§„åˆ™éƒ½æœ‰è‡ªå·±ç›¸åº”çš„æƒé‡å€¼ï¼Œæƒé‡å€¼è¶Šå¤§çš„è§„åˆ™ç”Ÿæ•ˆï¼Œä¸»è¦æœ‰ 5 ç§</p>
<ol>
<li>è¡Œå†…æ ·å¼ æƒé‡å€¼ 1000</li>
<li>id é€‰æ‹©å™¨ æƒé‡å€¼ 100</li>
<li>ç±»é€‰æ‹©èµ·ï¼Œå±æ€§å’Œä¼ªç±»(:hover,actived) æƒé‡å€¼ 10 4.å…ƒç´ ï¼Œä¼ªå…ƒç´  (::before,::after) æƒé‡å€¼ 1<br>
5.!important æœ€å¤§ï¼Œï¼ˆä½†ä¹Ÿéµä»æƒé‡è®¡ç®—è§„åˆ™ä¸‹é¢ä¼šæåˆ°ï¼‰<br>
æˆ‘ä»¬å†™çš„ css è§„åˆ™å°±æŒ‰ç…§ä»¥ä¸Šæƒé‡å€¼è¿›è¡Œç´¯åŠ ï¼Œä¾‹å¦‚ä»¥ä¸‹æ —å­ï¼š</li>
</ol>
<pre><code class="language-css">&lt;div style=&quot;.....&quot;&gt;&lt;/div&gt; =&gt;1000
#id{} =&gt;100
.class{}=&gt;10
body{} =&gt;1
p{}=&gt;1
</code></pre>
<p>å½“å†™ css è§„åˆ™æ—¶ä¼šæŒ‰ç…§å€¼è¿›è¡Œç´¯åŠ ï¼Œå€¼è¶Šå¤§æƒé‡è¶Šå¤§</p>
<pre><code class="language-css">body #id {} =&gt;å…ƒç´ 1 idé€‰æ‹©å™¨100 = 101
#id .class{} =&gt;idé€‰æ‹©å™¨100ç±»é€‰æ‹©å™¨ = 110
#id .class p{} =&gt; idé€‰æ‹©å™¨100  ç±»é€‰æ‹©å™¨10 å…ƒç´ æ ‡ç­¾1 = 111
</code></pre>
<h2 id="ä¸»è¦è§„åˆ™">ä¸»è¦è§„åˆ™</h2>
<p><strong>æ— è®ºå¤šå°‘ä¸ªåŒçº§æƒé‡ç´¯åŠ éƒ½ä¸ä¼šè¶…è¿‡é«˜ç­‰çº§æƒé‡å€¼</strong></p>
<pre><code class="language-css">.class .class .Nclass {
}
&lt; #id {
}
</code></pre>
<p><strong>ç›¸åŒæƒé‡å€¼ä½œç”¨äºåŒä¸€ä¸ªå…ƒç´ æ—¶æƒé‡å€¼å¤§çš„ç”Ÿæ•ˆ</strong></p>
<pre><code class="language-css">.test1 .test2{background:red} =&gt;20
.tetst1 .test2 p{background:black} =&gt;21
</code></pre>
<p>å‡è®¾ä»¥ä¸Šä¸¤æ¡éƒ½ä½œç”¨äºåŒä¸€ä¸ªå…ƒç´ ï¼Œä¸‹é¢æƒé‡å€¼é«˜çš„ä¼šç”Ÿæ•ˆ<br>
æœ‰æ—¶å€™!important åŠ äº†ä¹Ÿæ²¡ç”Ÿæ•ˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå®ƒä¹Ÿéµå¾ªæƒé‡å¤§å°è§„åˆ™ä¾‹å¦‚ï¼š</p>
<pre><code class="language-css">.test1 .test2{background:red!important} =&gt;20
.tetst1 .test2 p{background:black!important} =&gt;21
</code></pre>
<p>ä¸Šé¢éƒ½åŠ äº† important ä½†è¿˜æ˜¯æƒé‡å€¼æ›´å¤§çš„ä¼šç”Ÿæ•ˆ<br>
<strong>ç¦»å…ƒç´ æ ‡ç­¾è¶Šè¿‘çš„ç”Ÿæ•ˆ</strong><br>
åœ¨ä¸€ä¸ªå•ç‹¬çš„ css æ–‡ä»¶å†™å¦‚ä¸‹æ ·å¼</p>
<pre><code class="language-css">.nav-bar {
  background: red;
}
</code></pre>
<p>åœ¨ html çš„ style ä¸­å†™</p>
<pre><code class="language-html">&lt;head&gt;
  &lt;style&gt;
    .nav-bar {
      background: black;
    }
  &lt;/style&gt;
&lt;/head&gt;
</code></pre>
<p>ä»¥ä¸Šæ —å­ä¸­è™½ç„¶éƒ½ä¸€æ ·ä½†æ˜¯ä¸‹é¢çš„ css ä¼šç”Ÿæ•ˆ<br>
<a href="https://www.adobe.com/devnet/archive/dreamweaver/articles/css_specificity_02.html">è¯¦ç»†å‚é˜…ã€Understanding Specificityã€‘ </a></p>
<p><strong>ç›¸åŒçš„æƒé‡åé¢çš„ä¼šè¦†ç›–å‰é¢çš„</strong></p>
<pre><code class="language-css">p {
  background: red;
}
p {
  background: black;
}
</code></pre>
<h2 id="æœ€å">æœ€å</h2>
<p><strong>ä¸è¦ç”¨!important</strong><br>
æ°¸è¿œéƒ½ä¸è¦ä½¿ç”¨â€œ!importantâ€ï¼šâ€œå¦‚æœä½ é‡åˆ°äº†æƒé‡é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªè§£å†³æ–¹æ³•è‚¯å®šæ˜¯å»æ‰â€œ!importantâ€ï¼Œâ€œ!importantâ€ä¼šè¦†ç›–æ‰€æœ‰çš„æ ·å¼è§„åˆ™ï¼Œä½†â€œ!importantâ€æ ¹æœ¬æ²¡æœ‰ç»“æ„ä¸ä¸Šä¸‹æ–‡å¯è¨€ï¼Œæ‰€ä»¥å¾ˆ å®¹æ˜“æ‰¾ä¸åˆ°æ ·å¼å¤±æ•ˆçš„åŸå› </p>
<p>æœ¬æ–‡å‚è€ƒ<a href="https://www.w3cplus.com/css/css-specificity-things-you-should-know.html">ä½ åº”è¯¥çŸ¥é“çš„ css æƒé‡é—®é¢˜</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ less å…¨å±€æ¢è‚¤æ–¹æ¡ˆ]]></title>
        <id>https://icyfe.github.io/icyblog/post/less-quan-ju-huan-fu-fang-an/</id>
        <link href="https://icyfe.github.io/icyblog/post/less-quan-ju-huan-fu-fang-an/">
        </link>
        <updated>2020-03-19T08:18:58.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ–¹æ¡ˆåŸºäº-antd-ui">æ–¹æ¡ˆåŸºäº antd UI</h2>
<h2 id="æ–°å»º-globalless">æ–°å»º global.less</h2>
<p>æ–°å»º global.less åœ¨èµ„æºæ–‡ä»¶å¤¹ aseets/style ä¸‹ å…·ä½“ä»£ç å¦‚ä¸‹ è™½ç„¶è¿™ä¸ªæ²¡ä»€ä¹ˆç”¨ä½†æ˜¯å¿…é¡»å¾—åˆ›å»º</p>
<pre><code class="language-js">@primary-color: &quot;#f52533&quot; !important;

</code></pre>
<h2 id="æ–°å»º-varsless">æ–°å»º vars.less</h2>
<p>æ–°å»º vars.less åœ¨èµ„æºæ–‡ä»¶å¤¹ aseets/style(æ ¹æ®è‡ªå·±é¡¹ç›®æƒ…å†µè€Œå®š)</p>
<pre><code class="language-js">@import &quot;~antd/lib/style/themes/default.less&quot;; //å¼•å…¥antdçš„å˜é‡æ–‡ä»¶ï¼Œå®ç°å˜é‡çš„è¦†ç›–
@primary-color: #1da57a;
@link-color: #1da57a;
@btn-primary-bg: #1da57a;
:root {
 --primary-color-0: @primary-color; //color.lessä¸­åŠ å…¥cssåŸç”Ÿå˜é‡ï¼š--PC
}

</code></pre>
<h2 id="æ–°å»º-themcolorjs">æ–°å»º themColor.js</h2>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ æ–°å»º themColor.js ç”¨äºåŠ¨æ€æ›´æ”¹å…¨å±€ä¸»é¢˜è‰²</p>
<pre><code class="language-js">const path = require(&quot;path&quot;);
const { generateTheme, getLessVars } = require(&quot;antd-theme-generator&quot;);

const options = {
  stylesDir: path.join(__dirname, &quot;./src/assets/styles&quot;), //å¯¹åº”å…·ä½“ä½ç½®
  antDir: path.join(__dirname, &quot;./node_modules/antd&quot;), //å¯¹åº”å…·ä½“ä½ç½®
  varFile: path.join(__dirname, &quot;./src/assets/styles/vars.less&quot;), //å¯¹åº”å…·ä½“ä½ç½®
  mainLessFile: path.join(__dirname, &quot;./src/assets/styles/global.less&quot;), //å¯¹åº”å…·ä½“ä½ç½®
  themeVariables: [
    &quot;@primary-color&quot;,
    &quot;@secondary-color&quot;,
    &quot;@text-color&quot;,
    &quot;@text-color-secondary&quot;,
    &quot;@heading-color&quot;,
    &quot;@layout-body-background&quot;,
    &quot;@btn-primary-bg&quot;,
    &quot;@layout-header-background&quot;
  ],
  indexFileName: &quot;index.html&quot;,
  outputFilePath: path.join(__dirname, &quot;./public/color.less&quot;) //é¡µé¢å¼•å…¥çš„ä¸»é¢˜å˜é‡æ–‡ä»¶
};

generateTheme(options)
  .then(less =&gt; {
    console.log(&quot;Theme generated successfully&quot;);
  })
  .catch(error =&gt; {
    console.log(&quot;Error&quot;, error);
  });
</code></pre>
<h3 id="åœ¨æ¨¡æ¿-indexhtml-å°±æ˜¯æˆ‘ä»¬çš„ç»„ä»¶è¦æŒ‚è½½çš„-html-ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®">åœ¨æ¨¡æ¿ index.html (å°±æ˜¯æˆ‘ä»¬çš„ç»„ä»¶è¦æŒ‚è½½çš„ html) ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;link rel=&quot;icon&quot; href=&quot;%PUBLIC_URL%/favicon.ico&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;meta name=&quot;theme-color&quot; content=&quot;#000000&quot; /&gt;
    &lt;meta
      name=&quot;description&quot;
      content=&quot;Web site created using create-react-app&quot;
    /&gt;
    &lt;link rel=&quot;apple-touch-icon&quot; href=&quot;logo192.png&quot; /&gt;

    &lt;!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    --&gt;
    &lt;link rel=&quot;manifest&quot; href=&quot;%PUBLIC_URL%/manifest.json&quot; /&gt;
    &lt;!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike &quot;/favicon.ico&quot; or &quot;favicon.ico&quot;, &quot;%PUBLIC_URL%/favicon.ico&quot; will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    --&gt;
    &lt;title&gt;React App&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;!-- é‡ç‚¹æ˜¯è¿™é‡Œ start --&gt;
    &lt;link
      rel=&quot;stylesheet/less&quot;
      type=&quot;text/css&quot;
      href=&quot;%PUBLIC_URL%/color.less&quot;
      rel=&quot;external nofollow&quot;
    /&gt;
    &lt;script&gt;
      window.less = {
        async: false,
        env: &quot;production&quot;
      };
    &lt;/script&gt;
    &lt;script
      type=&quot;text/javascript&quot;
      src=&quot;https://cdnjs.cloudflare.com/ajax/libs/less.js/2.7.2/less.min.js&quot;
    &gt;&lt;/script&gt;
    &lt;!-- é‡ç‚¹æ˜¯è¿™é‡Œ end --&gt;
    &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;
    &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;
    &lt;!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the &lt;body&gt; tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    --&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="æœ€åä¿®æ”¹-packgejson-æ–‡ä»¶">æœ€åä¿®æ”¹ packge.json æ–‡ä»¶</h3>
<p>åœ¨ scripts ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç </p>
<pre><code class="language-js">  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node themeColor &amp;&amp; node scripts/start.js&quot;,
    &quot;build&quot;: &quot;node themeColor &amp;&amp; node scripts/build.js&quot;,
    &quot;test&quot;: &quot;node scripts/test.js&quot;
  },
</code></pre>
<h2 id="å¦‚ä½•æ›´æ”¹">å¦‚ä½•æ›´æ”¹</h2>
<p>åœ¨éœ€è¦åŠ¨æ€æ›´æ”¹çš„åœ°æ–¹ ä½¿ç”¨ä»¥ä¸‹ä»£ç å°±å¯ä»¥äº†</p>
<pre><code class="language-js">window.less
  .modifyVars({
    &quot;@primary-color&quot;: &quot;#FFB6C1&quot;,
    &quot;@link-color&quot;: &quot;#FFB6C1&quot;,
    &quot;@btn-primary-bg&quot;: &quot;#FFB6C1&quot;
  })
  .then(() =&gt; {})
  .catch(error =&gt; {
    // message.error(`Failed to update theme`);
  });
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Javascript this æŒ‡å‘é—®é¢˜]]></title>
        <id>https://icyfe.github.io/icyblog/post/javascript-this-zhi-xiang-wen-ti/</id>
        <link href="https://icyfe.github.io/icyblog/post/javascript-this-zhi-xiang-wen-ti/">
        </link>
        <updated>2019-10-03T08:06:55.000Z</updated>
        <content type="html"><![CDATA[<p>å…³äº this æŒ‡å‘è‚¯å®šé‡åˆ°è¿‡è®¸è®¸å¤šå¤šçš„å¥‡æ€ªé—®é¢˜ï¼Œè¿™éƒ½æ˜¯å› ä¸ºæ²¡å¼„æ¸…æ¥šå®ƒçš„æŒ‡å‘å¯¼è‡´ä¸€äº›è°ƒç”¨çš„é”™è¯¯ï¼Œä¸‹é¢æ€»ç»“å…ˆ this çš„æŒ‡å‘ã€‚</p>
<h2 id="1è°è°ƒç”¨äº†å®ƒthis-å°±æŒ‡å‘è°å½“æ˜¯å…¨å±€è°ƒç”¨ä¸”ä¸ºéä¸¥æ ¼æ¨¡å¼æ—¶-this-æŒ‡å…¨å±€åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æŒ‡å‘-windowå¦åˆ™æ˜¯-undefined"><strong>1.è°è°ƒç”¨äº†å®ƒï¼Œthis å°±æŒ‡å‘è°ï¼Œå½“æ˜¯å…¨å±€è°ƒç”¨ä¸”ä¸ºéä¸¥æ ¼æ¨¡å¼æ—¶ this æŒ‡å…¨å±€(åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æŒ‡å‘ window)ï¼Œå¦åˆ™æ˜¯ undefined</strong></h2>
<p>ä¸¾ä¸ªæ —å­<br>
éä¸¥æ ¼æ¨¡å¼</p>
<pre><code class="language-js">var value = 'global scope';
function a() {
  console.log(this.value);
}
a(); // global scope
</code></pre>
<p>ä¸¥æ ¼æ¨¡å¼</p>
<pre><code class="language-js">'use strict';
var value = 'global scope';
function a() {
  console.log(this.value);
}
a(); // undefined
</code></pre>
<p>åœ¨æµè§ˆå™¨ä¸­å…¨å±€çš„ this é»˜è®¤æ˜¯ windowï¼Œ å› æ­¤ a()åœ¨å…¨å±€ä¸­è¢«è°ƒç”¨ç›¸å½“äºæ˜¯ window.aï¼Œè°è°ƒç”¨å®ƒ this å°±æŒ‡å‘è°ï¼Œå› æ­¤è¿™é‡Œæ‰“å°å‡ºå…¨å±€å˜é‡çš„'global scope'<br>
åœ¨çœ‹ä¸€ä¸ªæ —å­ï¼š</p>
<pre><code class="language-js">var value = 'global scope';
var o = {
  value: 'local scope',
  a: function() {
    console.log(this.value);
  }
};

o.a(); //local scope
</code></pre>
<p>è¿™é‡Œé€šè¿‡åˆ›å»ºä¸€ä¸ª o å®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡ o è°ƒç”¨ this çš„æŒ‡å‘å°±æŒ‡å‘ oã€‚</p>
<h2 id="2call-apply-bind-æ”¹å˜thisæŒ‡å‘"><code>2.call, apply, bind æ”¹å˜thisæŒ‡å‘</code></h2>
<p>åœ¨ js ä¸­æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥æ˜¾ç¤ºçš„æ”¹å˜ this çš„æŒ‡å‘ï¼Œcall å’Œ apply é™¤äº†ä¼ å‚ä¸ä¸€æ ·å…¶æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œcall å’Œ apply ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯è¦ä¼ å…¥å°†è¦æŒ‡å‘çš„ this, call åé¢å¯æ¥å¤šä¸ªå‚æ•°ï¼Œapply åˆ™æ˜¯ç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯æ•°ç»„ã€‚</p>
<pre><code class="language-js">fn.call(this, arg1, ag2, ag3);
fn.apply(this, [...arg]);
</code></pre>
<p>bind çš„æœ¬è´¨æ˜¯å°è£…äº† apply å®ƒè¿”å›çš„ä¸€ä¸ªå‡½æ•°ã€‚<br>
æ¥çœ‹å‡ ä¸ªæ —å­:</p>
<pre><code class="language-js">var value = 'global scope';
function b() {
  console.log(this.value);
}
var o = {
  value: 'local scope',
  a: function() {
    console.log(this.value);
  }
};

b.call(o); //local scope
b.apply(o); //local scope
let c = b.bind(o);
c(); //local scope
</code></pre>
<p>ä¸Šé¢å‡ ä¸ªæ —å­éƒ½æ˜¯æ”¹å˜äº† this çš„æŒ‡å‘ï¼ŒåŸæœ¬åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘å…¨å±€çš„ this åº”è¯¥è¾“å‡º'global scope'ï¼Œæ”¹å˜ this æŒ‡å‘åæŒ‡å‘äº†ä¼ å…¥çš„ o å¯¹è±¡å› æ­¤æ‰“å°å‡º'local scope'<br>
call å’Œ apply çš„åŸç†å…¶å®æ˜¯åœ¨ä¼ å…¥çš„å¯¹è±¡å¢åŠ è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œä»è€Œæ”¹å˜ this çš„æŒ‡å‘ï¼Œæ‰§è¡Œå®Œååœ¨åˆ é™¤å‡½æ•°ï¼Œè¿™ä¸ªåé¢ä¼šæœ‰ä¸€ç« èŠ‚æ¥ä»¿å†™ call,apply å’Œ bind å‡½æ•°ã€‚</p>
<h2 id="3new-å…³é”®å­—">3.new å…³é”®å­—</h2>
<p>é€šè¿‡ new å…³é”®å­—è°ƒç”¨å‡½æ•°ä¼šä»¥æ„é€ å‡½æ•°çš„å½¢å¼è°ƒç”¨ä¼šå‘ç”Ÿä»¥ä¸‹æ­¥éª¤ 1.åˆ›å»ºä¸€ä¸ªå¯¹è±¡ 2.å°†å¯¹è±¡çš„å®ä¾‹åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹<br>
<strong>3.å°†å¯¹è±¡çš„ this ç»‘å®šåˆ°æ„é€ å‡½æ•°å¹¶åˆ›å»ºä¸€ç³»åˆ—å±æ€§</strong> 4.è¿”å›è¿™ä¸ªå¯¹è±¡<br>
å› æ­¤æˆ‘ä»¬å¯ä»¥ new å…³é”®å­—è°ƒç”¨çš„å‡½æ•°ä¹Ÿä¼šæ”¹å˜ this çš„æŒ‡å‘ï¼Œå®ƒæŒ‡å‘åˆ›å»ºå‡ºæ¥çš„å®ä¾‹å¯¹è±¡<br>
ä¸¾ä¸ªæ —å­ï¼š</p>
<pre><code class="language-js">var value = 'global scope';
function A() {
  this.value = 'local scope';
  this.sayValue = function() {
    console.log(this.value);
  };
}

let b = new A();
b.sayValue();
</code></pre>
<p>é€šè¿‡ new å†…éƒ¨å‘ç”Ÿçš„è¿‡ç¨‹æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸Šé¢çš„æ —å­å°† this æŒ‡å‘äº†æ–°åˆ›å»ºå‡ºæ¥çš„å®ä¾‹ b å› æ­¤æ‰“å° value æ—¶å€™å°±æ‰“å°å‡º'local scope'</p>
<h2 id="4-ç®­å¤´å‡½æ•°çš„-this">4ã€ç®­å¤´å‡½æ•°çš„ this</h2>
<p>åœ¨ ES6 ä¸­æ–°å¢äº†ç®­å¤´å‡½æ•°ç”¨æ³•ï¼Œå®ƒæœ¬èº«æ²¡æœ‰ç»‘å®š thisï¼Œå®ƒçš„ this æŒ‡å‘æ˜¯ç¦»çš„å®ƒæœ€è¿‘çš„ä¸€ä¸ªæ™®é€šå‡½æ•°æ‰€ç»‘å®šçš„ thisï¼Œåœ¨ ES5 ä¹‹å‰æˆ‘ä»¬åœ¨ä¸€äº›åŒ¿åå‡½æ•°ä¸ºäº†é˜²æ­¢ this æŒ‡å‘ä¸¢å¤±æˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·ç»‘å®š this</p>
<pre><code class="language-js">function a() {
  let self = this;
  this.value = 'Hi!';
  setTimeout(function() {
    console.log(self.value);
  }, 0);
}
</code></pre>
<p>åœ¨ ES6 ä¸­è¿™æ ·å°±å¯ä»¥äº†</p>
<pre><code class="language-js">function a() {
  this.value = 'Hi!';
  setTimeout(() =&gt; {
    console.log(this.value);
  }, 0);
}
</code></pre>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p><code>åªè¦è®°ä½ä¸€ç‚¹ã€‚åœ¨ç®­å¤´å‡½æ•°ä¸­çš„thisçš„æŒ‡å‘æ°¸è¿œæ˜¯ç¦»å®ƒæœ€è¿‘çš„ä¸€ä¸ªæ™®é€šå‡½æ•°æ‰€ç»‘å®šçš„this,å¦‚ä¸Šæ —å­ç¦»åŒ¿åå‡½æ•°æœ€è¿‘çš„æ™®é€šå‡½æ•°æ˜¯ aå‡½æ•°ï¼Œ å½“aè¢«è°è°ƒç”¨æ—¶ thiså°±æŒ‡å‘è°</code></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ‰‹å†™ç®€å•ç‰ˆç¬¦åˆ PromiseA+è§„èŒƒçš„ Promise]]></title>
        <id>https://icyfe.github.io/icyblog/post/shou-xie-jian-dan-ban-fu-he-promiseagui-fan-de-promise/</id>
        <link href="https://icyfe.github.io/icyblog/post/shou-xie-jian-dan-ban-fu-he-promiseagui-fan-de-promise/">
        </link>
        <updated>2019-10-01T02:05:52.000Z</updated>
        <content type="html"><![CDATA[<p>ä»Šå¤©æ‰‹å†™ä¸€ä¸ªç¬¦åˆ promiseA+è§„èŒƒçš„ promiseï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹å¯èƒ½å¿«è¢«å†™çƒ‚äº†å§ï¼Œä½†è¿˜æ˜¯ä½œä¸ºå­¦ä¹ æ¯”è¾ƒåŠ æ·±è‡ªå·±å¯¹ Promise çš„ç†è§£ã€‚<br>
å…ˆæ¥äº†è§£ Promise æ˜¯ä»€ä¹ˆï¼Œpromise çš„å‡ºç°ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œæœ€åæˆ‘ä»¬æ ¹æ® promiseA+è‡ªå·±æ‰‹å†™å®ç°ä¸€ä¸ª promise</p>
<h2 id="ä¸€-promise-æ˜¯ä»€ä¹ˆ">ä¸€ã€Promise æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>è´´ä¸€æ®µ MDN çš„ä»‹ç»<br>
<code>Promise å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆçŠ¶æ€ï¼ˆå®Œæˆæˆ–å¤±è´¥ï¼‰ï¼Œä»¥åŠå…¶è¿”å›çš„å€¼..... Promise å¯¹è±¡æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ˆä»£ç†ä¸€ä¸ªå€¼ï¼‰ï¼Œè¢«ä»£ç†çš„å€¼åœ¨Promiseå¯¹è±¡åˆ›å»ºæ—¶å¯èƒ½æ˜¯æœªçŸ¥çš„ã€‚å®ƒå…è®¸ä½ ä¸ºå¼‚æ­¥æ“ä½œçš„æˆåŠŸå’Œå¤±è´¥åˆ†åˆ«ç»‘å®šç›¸åº”çš„å¤„ç†æ–¹æ³•ï¼ˆhandlersï¼‰ã€‚ è¿™è®©å¼‚æ­¥æ–¹æ³•å¯ä»¥åƒåŒæ­¥æ–¹æ³•é‚£æ ·è¿”å›å€¼ï¼Œä½†å¹¶ä¸æ˜¯ç«‹å³è¿”å›æœ€ç»ˆæ‰§è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªèƒ½ä»£è¡¨æœªæ¥å‡ºç°çš„ç»“æœçš„promiseå¯¹è±¡ã€‚</code><br>
é€šä¿—ç‚¹æ¥è¯´å°±æ˜¯è§£å†³å¼‚æ­¥æ“ä½œé—®é¢˜çš„ä¸€ä¸ªç±»ã€‚<br>
<a href="url">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise</a></p>
<h2 id="äºŒ-promise-çš„å‡ºç°ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜">äºŒã€Promise çš„å‡ºç°ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2>
<p>ç›¸ä¿¡æ¥è§¦è¿‡å¼‚æ­¥æ“ä½œçš„åŒå­¦éƒ½ç»å†è¿‡å›è°ƒåœ°ç‹±ï¼Œä¸€ä¸ªå¼‚æ­¥æ¥ç€ä¸€ä¸ªå¼‚æ­¥å¦‚ä¸‹æ‰€ç¤º</p>
<pre><code class="language-js">asyncFunc1(opt, (...args1) =&gt; {
  asyncFunc2(opt, (...args2) =&gt; {
    asyncFunc3(opt, (...args3) =&gt; {
      asyncFunc4(opt, (...args4) =&gt; {
        // some operation
      });
    });
  });
});
</code></pre>
<p>è¿™æ ·çš„ä»£ç ä¸ä»…éš¾ä»¥ç»´æŠ¤ï¼Œå¯è¯»æ€§ä¹Ÿå·®ç®€ç›´ç—›è‹¦ï¼ŒPromise çš„å‡ºç°é€šè¿‡é“¾å¼è°ƒç”¨å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œé€šè¿‡ Promise å¯ä»¥å†™æˆè¿™æ ·</p>
<pre><code>asyncFunc1('...â€œ).then(res=&gt; {
    return asyncFunc2(res);
}).then(res =&gt; {
    return asyncFunc3(res);
}).then(res =&gt; {
   return asyncFunc4(res);
}).then(res =&gt;{
console.log(res)
})
</code></pre>
<p>è¿™æ ·çš„æ¯ä¸€æ¬¡çš„ then çš„è¿”å›å€¼éƒ½å¯ä»¥ä½œä¸ºä¸‹ä¸€ä¸ªçš„å¼‚æ­¥æ“ä½œçš„å‚æ•°ï¼Œè¿™æ ·å›è°ƒåœ°ç‹±çš„é—®é¢˜å°±è½»æ˜“è§£å†³äº†ã€‚<br>
æœ¬æ–‡å¯¹ Promise çš„ç”¨æ³•ä¸å¤šåšä»‹ç»è·Ÿå¤šçš„ç”¨æ³•å¯çœ‹é˜®ä¸€å³°è€å¸ˆçš„ es6 å…¥é—¨<a href="url">http://es6.ruanyifeng.com/</a></p>
<h2 id="ä¸‰-æ‰‹å†™ä¸€ä¸ªç¬¦åˆ-promiseaè§„èŒƒçš„-promise">ä¸‰ã€æ‰‹å†™ä¸€ä¸ªç¬¦åˆ PromiseA+è§„èŒƒçš„ Promise</h2>
<p>å¼€å§‹å†™ä¹‹å‰è´´ä¸Š PromiseA+è§„èŒƒçš„é“¾æ¥ <a href="url">http://www.ituring.com.cn/article/66566</a><br>
<strong>1ã€é¦–å…ˆ Promise æœ‰ä¸‰ç§çŠ¶æ€ç­‰å¾…(pending),<br>
æˆåŠŸæ€(fulfilled,è§„èŒƒä¸­ç§°ä¸ºæ‰§è¡Œæ€æˆ‘è®¤ä¸ºè§£é‡Šä¸ºæˆåŠŸæ€æˆ–è€…å®Œæˆæ€æ›´å¥½ç†è§£),<br>
å¤±è´¥(rejected),å¹¶ä¸”åªèƒ½ä¸ºä»¥ä¸Šä¸‰ç§çŠ¶æ€çš„å…¶å®ä¸€ç§ï¼Œç­‰å¾…æ€å¯æ”¹å˜ä¸ºæˆåŠŸæ€æˆ–è€…å¤±è´¥æ€ï¼ŒæˆåŠŸæ€æœ‰æˆåŠŸçš„å€¼ä¸èƒ½æ”¹å˜ä¸ºå…¶ä»–ä»»ä½•çŠ¶æ€ï¼Œå¤±è´¥æ€æœ‰å¤±è´¥çš„å€¼ä¸èƒ½æ”¹å˜ä¸ºå…¶ä»–ä»»ä½•çŠ¶æ€ã€‚<br>
2ã€Promise æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°æ–‡æ¡£ä¸­ç§°ä¸ºâ€˜executorâ€™ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ‰§è¡Œè€…è¯´æ˜åœ¨æ„é€ å‡½æ•°ä¸€è°ƒç”¨çš„æ—¶å€™å°±è¢«æ‰§è¡Œï¼Œè¿™ä¸ª executor å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ resolve,rejectï¼Œå½“ executor å‡½æ•°ä¸­çš„ resovle å‡½æ•°è¢«è°ƒç”¨æ—¶çŠ¶æ€æ”¹å˜ä¸ºæˆåŠŸæ€(fulfiiled)ï¼Œreject å‡½æ•°è¢«è°ƒç”¨æ—¶çŠ¶æ€å°±æ”¹å˜ä¸ºå¤±è´¥æ€(rejected),å½“ executor å‡½æ•°æ‰§è¡Œå‡ºé”™æ—¶å°±ç›´æ¥è°ƒç”¨ reject æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬è¦æ•è· executor å‡½æ•°æ‰§è¡Œæ—¶çš„å¼‚å¸¸ã€‚</strong></p>
<p>æ ¹æ®è¿™ä¸¤æ¡æˆ‘ä»¬å†™åˆå§‹çš„ä»£ç </p>
<pre><code class="language-js">class Promise {
  constructor(executor) {
    //çŠ¶æ€
    this.status = 'pending';
    //å¤±è´¥çš„å€¼
    this.reason = null;
    //æˆåŠŸçš„å€¼
    this.value = null;

    let resolve = value =&gt; {
      if (this.status == 'pending') {
        this.status = 'fulfilled';
        this.value = value;
      }
    };
    let reject = reason =&gt; {
      if (this.status == 'pending') {
        this.status = 'rejected';
        this.reason = reason;
      }
    };
    //å½“è°ƒç”¨æ„é€ å‡½æ•°æ—¶å°±è°ƒç”¨executorå‡½æ•°å¹¶æ•è·å¼‚å¸¸
    try {
      executor(resolve, reject);
    } catch (error) {
      reject(error);
    }
  }
}
</code></pre>
<p><strong>3ã€promiseA+è§„å®šå¿…é¡»è¦æœ‰ä¸€ä¸ª then æ–¹æ³•å¯ä»¥è®¿é—®å…¶æˆåŠŸæˆ–å¤±è´¥æ—¶å€™çš„è¿”å›å€¼ï¼Œthen æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸º onFulfilled å’Œ onRejectdï¼Œå¹¶ä¸”è¿˜è§„å®šäº†å½“ä¸¤ä¸ªå‚æ•°ä¸æ˜¯å‡½æ•°æ—¶å…¶å€¼è¢«å¿½ç•¥</strong><br>
<strong>4ã€å½“ onFulfilled å’Œ onRejected æ˜¯å‡½æ•°æ—¶ï¼ŒonFulfilled å‡½æ•°åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨ promise æ‰§è¡ŒæˆåŠŸç»“æŸåï¼Œå¹¶å°† promise çš„è¿”å›å€¼ä½œä¸ºç»ˆå€¼ï¼ŒonReject å‡½æ•°åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå½“ promise è¢«æ‹’ç»æ‰§è¡Œåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º promise çš„æ®å› ã€‚</strong></p>
<p>æ ¹æ®è¿™ä¸¤æ¡æˆ‘ä»¬æ¥å†™ then çš„åˆå§‹æ–¹æ³•</p>
<pre><code class="language-js">//thenæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°onFulfilled,onRejected
 then(onFulfilled, onRejected) {
     //å¦‚æœéå‡½æ•°å°±ç›´æ¥è¿”å›å€¼
     onFulfilled = typeof onFulfilled == 'function' ? onFulfilled : v =&gt; v
     // é”™è¯¯çš„å°±ç›´æ¥æŠ›é”™ä¸åœ¨æ‰§è¡Œ
     onRejected = typeof onRejected == 'function' ? onRejected : err =&gt; { throw err }
     //æˆåŠŸåç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶ç»“æœä½œä¸ºå‚æ•°
     if (this.status == 'fulfilled') {
         onFulfilled(this.value)
     }
     // å¤±è´¥åç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶æ‹’å› ä½œä¸ºå‚æ•°
     if (this.status == 'rejected') {
         onRejected(this.reason)
     }
 }
}
</code></pre>
<p><strong>5ã€then æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª promise å¤šæ¬¡è°ƒç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤º<br>
let p = new Promise()<br>
p.then()<br>
p.then()<br>
å½“ promise æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ onFulfilled éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ<br>
å½“ promise è¢«æ‹’ç»æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„ onRejected éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ</strong></p>
<p>ä»¥ä¸Šä»£ç åªèƒ½è§£å†³åŒæ­¥é—®é¢˜ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¼‚æ­¥æ‰§è¡Œçš„æ—¶å€™æˆ‘ä»¬è¦æœ‰ä¸¤ä¸ªé˜Ÿåˆ—(å½“å¤šæ¬¡è°ƒç”¨çš„æ—¶å€™)åœ¨ç­‰å¾…çŠ¶æ€çš„æ—¶å€™åˆ†åˆ«å­˜æ”¾æˆåŠŸå’Œå¤±è´¥æ—¶å€™çš„å›è°ƒï¼Œå¹¶åœ¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™ä¾æ¬¡å–å‡ºæ¥æ‰§è¡Œ</p>
<p>åœ¨æ„é€ å‡½æ•°æ·»åŠ ä»£ç </p>
<pre><code class="language-js">//æˆåŠŸå›è°ƒå­˜æ”¾
this.resolvedCallbacks = [];
//å¤±è´¥å›è°ƒå­˜æ”¾
this.rejectedCallbacks = [];
let resolve = value =&gt; {
  if (this.status == 'pending') {
    this.status = 'fulfilled';
    this.value = value;
    //ä¾æ¬¡å–å‡ºå›è°ƒæ‰§è¡Œ
    this.resolvedCallbacks.map(cb =&gt; cb());
  }
};
let reject = reason =&gt; {
  if (this.status == 'pending') {
    this.status = 'rejected';
    this.reason = reason;
    //ä¾æ¬¡å–å‡ºå›è°ƒæ‰§è¡Œ
    this.rejectedCallbacks.map(cb =&gt; cb());
  }
};
</code></pre>
<p>åœ¨ then å‡½æ•°æ·»åŠ  pending çŠ¶æ€åˆ¤æ–­</p>
<pre><code class="language-js">//å½“æ—¶ç­‰å¾…çŠ¶æ€æ—¶å€™å­˜æ”¾å¤±è´¥æˆ–æˆåŠŸçš„å›è°ƒ
if (this.status == 'pending') {
  this.rejectedCallbacks.push(() =&gt; {
    onRejected(this.reason);
  });
  this.resolvedCallbacks.push(() =&gt; {
    onFulfilled(this.value);
  });
}
</code></pre>
<p><strong>6ã€è§„èŒƒè§„å®š then å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ª promise å¯¹è±¡ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“è§„èŒƒä¸­çš„ promise æ˜¯å’Œé“¾å¼è°ƒç”¨çš„å¦‚ p.then().then()è¿™æ ·å½¢å¼çš„è°ƒç”¨ç”¨æ¥è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿”å›ä¸€ä¸ª promise å¯¹è±¡å¯ä¾›é“¾å¼è°ƒç”¨ï¼Œè§„èŒƒä¸­ç§°å®ƒä¸º promise2 <code>promise2 = promise1.then(onFulfilled, onRejected);</code><br>
7ã€then ä¼šæœ‰ä¸ªè¿”å›å€¼è§„èŒƒä¸­ç§°å®ƒä¸º x å¹¶ä½œä¸ºä¸‹ä¸€ä¸ª promise çš„å‚æ•°è¿›è¡Œä¼ é€’ï¼Œ<br>
è¿™ä¸ª x å€¼å°±æ˜¯ onFulfilled æˆ–è€… onRejected æ‰§è¡Œåçš„è¿”å›å€¼ï¼Œ<br>
å¹¶ä¸”è¿™ä¸ª x å€¼éœ€è¦åšåˆ¤æ–­ï¼Œåˆ¤æ–­çš„å‡½æ•°ä¸º resolvePromiseï¼Œ<br>
å¦‚æœ x æ˜¯æ™®é€šå€¼å°±ç›´æ¥ä½œä¸º promise2 çš„ç»ˆå€¼ï¼Œå¦‚æœ x æ˜¯ promise å°±å–å¾— x çš„æœ€ç»ˆçŠ¶æ€ä½œä¸º promise2 çš„ç»“æœã€‚ resolvePromise æœ‰å››ä¸ªå‚æ•° promise2,x,resolve,reject,å…¶ä¸­ resolve å’Œ reject ä¸º promise2 çš„ã€‚</strong></p>
<p>æ ¹æ®è¿™ä¸¤æ¡å¾—å‡ºä»¥ä¸‹ä»£ç </p>
<pre><code class="language-js"> //thenæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°onFulfilled,onRejected
    then(onFulfilled, onRejected) {
        // è¿”å›promiseå¯¹è±¡
        let promise2 = new Promise((resolve, reject) =&gt; {
            //å¦‚æœéå‡½æ•°å°±ç›´æ¥è¿”å›å€¼
            onFulfilled = typeof onFulfilled == 'function' ? onFulfilled : v =&gt; v
            // é”™è¯¯çš„å°±ç›´æ¥æŠ›é”™ä¸åœ¨æ‰§è¡Œ
            onRejected = typeof onRejected == 'function' ? onRejected : err =&gt; { throw err }
            //æˆåŠŸåç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶ç»“æœä½œä¸ºå‚æ•°
            if (this.status == 'fulfilled') {
                //x ä¸ºonFufilledçš„å€¼
                let x = onFulfilled(this.value)
                // åˆ¤æ–­xçš„å‡½æ•°
                resolvePromise(promise2, x, resolve, reject)
            }
            // å¤±è´¥åç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶æ‹’å› ä½œä¸ºå‚æ•°
            if (this.status == 'rejected') {
                onRejected(this.reason)
                resolvePromise(promise2, x, resolve, reject)
            }
            //å½“æ—¶ç­‰å¾…çŠ¶æ€æ—¶å€™å­˜æ”¾å¤±è´¥æˆ–æˆåŠŸçš„å›è°ƒ
            if (this.status == 'pending') {
                this.rejectedCallbacks.push(() =&gt; {
                    let x = onRejected(this.reason)
                    resolvePromise(promise2, x, resolve, reject)
                })
                this.resolvedCallbacks.push(() =&gt; {
                    onFulfilled(this.value)
                    resolvePromise(promise2, x, resolve, reject)
                })
            }
        })
        return promise2
    }
</code></pre>
<p><strong>8ã€resolvePromise å®ç°çš„åŠŸèƒ½ä¸»è¦å°±æ˜¯åˆ¤æ–­ x çš„å€¼è§„èŒƒè§„å®šäº†ä»¥ä¸‹å‡ ç‚¹ 1.å¦‚æœ x æŒ‡å‘åŒä¸€å¯¹è±¡å°±æŠ›é”™ï¼Œé˜²æ­¢ç›¸äº’å¼•ç”¨çš„æƒ…å†µå‡ºç°ï¼Œå¹¶ä¸” x ä¸ä¸ºç©ºï¼Œ 2.å¦‚æœ x æ˜¯æ™®é€šå€¼å°±ç›´æ¥ resolve 3.å¦‚æœ x æ˜¯å‡½æ•°æˆ–è€…å¯¹è±¡(åŒ…æ‹¬ promise)<br>
.å®šä¹‰ then å¹¶ä½¿å¾— then = x.then()----promiseA+åŸæ–‡â€˜Otherwise, if x is an object or function,Let then be x.thenâ€™ï¼Œå¹¶æ•è·å– then è¿‡ç¨‹çš„å¼‚å¸¸å¦‚æœå‡ºé”™å°±ç›´æ¥ reject()<br>
.å¦‚æœ then æ˜¯å‡½æ•°å°±è°ƒç”¨ call æ‰§è¡Œ this ä¸ºå½“å‰çš„ x,åé¢åˆ†åˆ«æ˜¯æˆåŠŸå’Œå¤±è´¥çš„å›è°ƒï¼Œå¦‚æœ then éå‡½æ•°å°±ç›´æ¥ resolve<br>
.å¹¶ä¸”æˆåŠŸå’Œå¤±è´¥åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå› æ­¤æˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ª called æ¥æ ‡è®°æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡æˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒï¼Œå¦‚æœæˆåŠŸçš„è¿”å›å€¼ä»ç„¶æ˜¯ Promise å°±é€’å½’è°ƒç”¨ resovlePromise å‡½æ•°</strong></p>
<p>æ ¹æ®è¿™æ¡æˆ‘ä»¬æ¥å†™ resovlePromise å‡½æ•°</p>
<pre><code class="language-js">function resolvePromise(promise2, x, resolve, reject) {
  if (x == promise2) {
    return new TypeError('Error');
  }
  let called = false; //å®šä¹‰æ ‡å¿—ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨
  // x ä¸èƒ½ä¸ºç©ºï¼Œä¸”ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°æ—¶ï¼Œä¸ºæ™®é€šå€¼å°±ç›´æ¥resovle
  if (x != null &amp;&amp; (typeof x == 'object' || typeof x == 'function')) {
    //å®šä¹‰then å¹¶æ•è·å¼‚å¸¸
    try {
      let then = x.then();
      //å¦‚æœthenä¸ºå‡½æ•°ï¼Œé»˜è®¤ä¸ºpromiseå¯¹è±¡å°±ç»§ç»­é€’å½’è§£æ
      if (typeof then == 'function') {
        then.call(
          x,
          y =&gt; {
            //åªå…è®¸è¢«è°ƒç”¨ä¸€æ¬¡
            if (called) return;
            called = true;
            resolvePromise(promise2, y, resolve, reject);
          },
          err =&gt; {
            if (called) return;
            called = true;
            reject(err);
          }
        );
      } else {
        if (called) return;
        called = true;
        resolve(x);
      }
    } catch (error) {
      if (called) return;
      called = true;
      reject(error);
    }
  } else {
    resolve(x);
  }
}
</code></pre>
<p>å¥½äº†è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªç¬¦åˆè§„èŒƒçš„ Promise</p>
<p>é™„ä¸Š all,race,resolve,rejectï¼Œcatch,finlly ä»£ç </p>
<pre><code class="language-js">Promise.resolve = function(v) {
  return new Promise((resolve, reject) =&gt; {
    resolve(v);
  });
};
Promise.reject = function(err) {
  return new Promise((resolve, reject) =&gt; {
    resolve(err);
  });
};
Promise.race = function(promises) {
  return new Promise((resolve, reject) =&gt; {
    for (let i = 0; i &lt; promises.length; i++) {
      promises[i].then(resolve, reject);
    }
  });
};
Promise.all = function(promises) {
  let arr = [];
  let index = 0;
  return new Promise((resolve, reject) =&gt; {
    for (let i = 0; i &lt; promises.length; i++) {
      promises[i].then(data =&gt; {
        addResult(i, data);
      }, reject);
    }
    function addResult(i, data) {
      if (index == arr.length) {
        resolve(arr);
      }
      index++;
      arr[i].push(data);
    }
  });
};
Promise.catch = function(errFn) {
  return this.then(null, errFn);
};
Promise.finally = function(fn) {
  this.then(
    () =&gt; {
      fn();
    },
    () =&gt; {
      fn();
    }
  );
  return this;
};
</code></pre>
<p>å®Œæ•´ä»£ç </p>
<pre><code class="language-js">
class Promise {
    constructor(executor) {
        //çŠ¶æ€
        this.status = 'pending'
        //å¤±è´¥çš„å€¼
        this.reason = null
        //æˆåŠŸçš„å€¼
        this.value = null
        //æˆåŠŸå›è°ƒå­˜æ”¾
        this.resolvedCallbacks = []
        //å¤±è´¥å›è°ƒå­˜æ”¾
        this.rejectedCallbacks = []
        let resolve = (value) =&gt; {
            if (this.status == 'pending') {
                this.status = 'fulfilled'
                this.value = value
                //ä¾æ¬¡å–å‡ºå›è°ƒæ‰§è¡Œ
                this.resolvedCallbacks.map(cb =&gt; cb())
            }
        }
        let reject = (reason) =&gt; {
            if (this.status == 'pending') {
                this.status = 'rejected'
                this.reason = reason
                //ä¾æ¬¡å–å‡ºå›è°ƒæ‰§è¡Œ
                this.rejectedCallbacks.map(cb =&gt; cb())
            }
        }
        //å½“è°ƒç”¨æ„é€ å‡½æ•°æ—¶å°±è°ƒç”¨executorå‡½æ•°å¹¶æ•è·å¼‚å¸¸
        try {
            executor(resolve, reject)
        } catch (error) {
            reject(error)
        }
    }
    //thenæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°onFulfilled,onRejected
    then(onFulfilled, onRejected) {
        // è¿”å›promiseå¯¹è±¡
        let promise2 = new Promise((resolve, reject) =&gt; {
            //å¦‚æœéå‡½æ•°å°±ç›´æ¥è¿”å›å€¼
            onFulfilled = typeof onFulfilled == 'function' ? onFulfilled : v =&gt; v
            // é”™è¯¯çš„å°±ç›´æ¥æŠ›é”™ä¸åœ¨æ‰§è¡Œ
            onRejected = typeof onRejected == 'function' ? onRejected : err =&gt; { throw err }
            //æˆåŠŸåç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶ç»“æœä½œä¸ºå‚æ•°
            if (this.status == 'fulfilled') {
                //x ä¸ºonFufilledçš„å€¼
                let x = onFulfilled(this.value)
                // åˆ¤æ–­xçš„å‡½æ•°
                resolvePromise(promise2, x, resolve, reject)
            }
            // å¤±è´¥åç«‹å³æ‰§è¡Œ,å¹¶å°†å…¶æ‹’å› ä½œä¸ºå‚æ•°
            if (this.status == 'rejected') {
                onRejected(this.reason)
                resolvePromise(promise2, x, resolve, reject)
            }
            //å½“æ—¶ç­‰å¾…çŠ¶æ€æ—¶å€™å­˜æ”¾å¤±è´¥æˆ–æˆåŠŸçš„å›è°ƒ
            if (this.status == 'pending') {
                this.rejectedCallbacks.push(() =&gt; {
                    let x = onRejected(this.reason)
                    resolvePromise(promise2, x, resolve, reject)
                })
                this.resolvedCallbacks.push(() =&gt; {
                    onFulfilled(this.value)
                    resolvePromise(promise2, x, resolve, reject)
                })
            }
        })
        return promise2
    }
}
function resolvePromise(promise2, x, resolve, reject) {
    if (x == promise2) {
        return new TypeError('Error')
    }
    let called = false //å®šä¹‰æ ‡å¿—ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨
    // x ä¸èƒ½ä¸ºç©ºï¼Œä¸”ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°æ—¶ï¼Œä¸ºæ™®é€šå€¼å°±ç›´æ¥resovle
    if (x != null &amp;&amp; (typeof x == 'object' || typeof x == 'function')) {
        //å®šä¹‰then å¹¶æ•è·å¼‚å¸¸
        try {
            let then = x.then()
            //å¦‚æœthenä¸ºå‡½æ•°ï¼Œé»˜è®¤ä¸ºpromiseå¯¹è±¡å°±ç»§ç»­é€’å½’è§£æ
            if (typeof then == 'function') {
                then.call(x, y =&gt; {
                    //åªå…è®¸è¢«è°ƒç”¨ä¸€æ¬¡
                    if (called) return
                    called = true
                    resolvePromise(promise2, y, resolve, reject)
                }, err =&gt; {
                    if (called) return
                    called = true
                    reject(err)
                })
            } else {
                if (called) return
                called = true
                resolve(x)
            }
        } catch (error) {
            if (called) return
            called = true
            reject(error)
        }
    } else {
        resolve(x)
    }
}
Promise.resolve = function (v) {
    return new Promise((resolve, reject) =&gt; {
        resolve(v)
    })
}
Promise.reject = function (err) {
    return new Promise((resolve, reject) =&gt; {
        reject(err)
    })
}
Promise.race = function (promises) {
    return new Promise((resolve, reject) =&gt; {
        for (let i = 0; i &lt; promises.length; i++) {
            Promise.resolve(promises[i]).then((resolve,reject));
        }
    })
}
Promise.all = function (promises) {
    let arr = []
    let index = 0;
   let resultarr =[];
   let count = 0;
   len asynclen = promises.length
    return new Promise((resolve, reject) =&gt; {
        for (let i = 0; i &lt;asynclen ; i++) {
            promises[i].then((value) =&gt; {
                count++;
                resultarr.push(value);
               if(count==asynclen ){
                      resolve(resultarr)
                 }
            }, reject)
        }
    })
}
Promise.catch = function (errFn) {
    return this.then(null, errFn);
}
Promise.finally = function (fn) {
    this.then(() =&gt; {
        fn();
    }, () =&gt; {
        fn();
    });
    return this;
}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å®ç°ä¸€ä¸ªç®€å•çš„ MVVM]]></title>
        <id>https://icyfe.github.io/icyblog/post/shi-xian-yi-ge-jian-dan-de-mvvm/</id>
        <link href="https://icyfe.github.io/icyblog/post/shi-xian-yi-ge-jian-dan-de-mvvm/">
        </link>
        <updated>2019-09-17T13:05:10.000Z</updated>
        <content type="html"><![CDATA[<p>ç”¨è¿‡ vue çš„éƒ½çŸ¥é“åŒå‘ç»‘å®šï¼ŒåŒå‘ç»‘å®šå°±æ˜¯å½“ view çš„æ•°æ®æ”¹å˜çš„æ—¶å€™ data çš„æ•°æ®ä¹Ÿä¼šåŒæ—¶å˜åŒ–ã€‚vue çš„åŒå‘ç»‘å®šå…¶å®å°±æ˜¯åŸºäº Object.defineProperty çš„æ•°æ®åŠ«æŒåŠ ä¸Šå‘å¸ƒ-è®¢é˜…æ¨¡å¼å®ç°çš„ã€‚æˆ‘ä»¬åŸºäºè¿™ä¸¤ç‚¹æ¥ç†ä¸€ä¸‹å®ç°çš„æ€è·¯ï¼Œæˆ‘ä»¬è¦ä¸€ä¸ªæ•°æ®çš„è§‚å¯Ÿè€… observe æ¥å®ç°å¯¹æ•°æ®çš„åŠ«æŒï¼Œ å½“æ•°æ®å˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æœ‰ä¸€ä¸ªäº‹ä»¶çš„æ´¾å‘è€…é€šçŸ¥è®¢é˜…è€…å®æ—¶æ›´æ–°æ•°æ®ï¼ŒåŒæ—¶æˆ‘ä»¬åº”è¯¥è¿˜è¦æœ‰ä¸€ä¸ª complie æ¥è¿›è¡ŒæŒ‡ä»¤è§£æï¼Œå°†è¿™äº›å…³è”èµ·æ¥ï¼Œå…ˆæ¥çœ‹çœ‹æœ€ç»ˆå®ç°çš„æ•ˆæœ<br>
<img src="https://user-images.githubusercontent.com/44893721/55455070-bc4cdf80-5614-11e9-89ea-fb72997507f3.png" alt="L$IT(BW0 Q %TT7Q A9W_9Y" loading="lazy"><br>
<img src="https://user-images.githubusercontent.com/44893721/55455171-2f565600-5615-11e9-8b95-5669d8479f31.gif" alt="aaa" loading="lazy"></p>
<p>é¦–å…ˆä¸ºäº†èƒ½åƒ vue ä¸€æ ·è°ƒç”¨ï¼Œæˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ª mvvm ç±»ï¼Œé‡Œé¢åˆå§‹åŒ–ä¼ å…¥çš„å‚æ•°ã€‚</p>
<pre><code class="language-js">class Mvvm {
  constructor(option) {
    this.methods = option.methods; //æ–¹æ³•
    this.data = option.data; // æ•°æ®
    this.target = null; //è®°å½•watcher
    this.element = document.getElementById(option.el); //è·å–æ ¹å…ƒç´ 
    this.observe(this, this.data); //è®¾ç«‹è§‚å¯Ÿè€…å¯¹dataé‡Œé¢çš„æ•°æ®è¿›è¡ŒåŠ«æŒ
    this.compile(this.element); //æŒ‡ä»¤è§£æï¼Œæ•´åˆ
  }
}
</code></pre>
<h2 id="observe">Observe</h2>
<p>Observe å–å‡º data ä¸­æ‰€æœ‰çš„å±æ€§å¹¶å¯¹å…¶è¿›è¡ŒåŠ«æŒï¼Œåœ¨ Mvvm ç±»ä¸­æ·»åŠ  observe æ–¹æ³•</p>
<pre><code class="language-js">    observe(root, data) {
        for (let key in data) {
            this.definedRective(root, key, data[key])
        }
    }
    definedRective(root, key, value) {
        if (typeof value == 'object') {
            this.observe(value, value) //å¦‚æœè¿˜æœ‰å­å±æ€§è¿˜æ˜¯å¯¹è±¡é€’å½’å–å‡º
        }
        Object.defineProperty(root, key, {
            set(newVal) {
             if (value == newVal) return //å¦‚æœæ•°æ®æ²¡æ”¹å˜å°±ç›´æ¥è¿”å›
                value = newVal // è®°å½•æ”¹å˜çš„å€¼
            },
            get() {
                return value
            }
        })
    }
</code></pre>
<p>è¿™é‡Œ observe å–å‡º data ä¸­çš„å±æ€§æ•°æ®ï¼Œå¦‚æœå­å±æ€§è¿˜æ˜¯ä¸ªå¯¹è±¡å°±è¿›è¡Œé€’å½’ï¼Œè¿™æ ·å­å±æ€§å¦‚æœå‘ç”Ÿäº†å˜åŒ–ä¹Ÿèƒ½ç›‘å¬çš„åˆ°äº†ã€‚è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬å·²ç»å¯ä»¥åœ¨æ•°æ®å˜åŒ–çš„æ—¶å€™å¯¹æ•°æ®è¿›è¡Œæ‹¦æˆªï¼Œä½†æ˜¯æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªäº‹ä»¶çš„æ¥æ”¶å’Œæ´¾å‘è°ƒåº¦å‘˜ï¼Œè®©è®¢é˜…æ¶ˆæ¯çš„äººå¯ä»¥å®æ—¶çš„çŸ¥é“æ•°æ®æ›´æ–°ã€‚</p>
<h2 id="dispatcher">Dispatcher</h2>
<p>Dispatcher ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯å¯¹äº‹ä»¶çš„æ¥å—å’Œå‘å¸ƒï¼Œè®©ç›‘å¬çš„äººå¯ä»¥å®æ—¶çš„çŸ¥é“æ•°æ®çš„æ›´æ–°å¹¶åŒæ­¥çš„å¯¹ dom çš„æ•°æ®è¿›è¡Œæ›´æ–°ã€‚</p>
<pre><code class="language-js">class Dispatcher {
  constructor() {
    this.watchers = []; //ç›‘å¬è€…é˜Ÿåˆ—
  }
  add(watcher) {
    this.watchers.push(watcher); //æ¥å—ç›‘å¬è€…
  }
  notify(value) {
    console.log('æ›´æ–°');
    this.watchers.forEach(watcher =&gt; {
      watcher.update(value);
    }); //é€šçŸ¥æ›´æ–°
  }
}
</code></pre>
<p>Dispatcher å…¶å®å°±ç›¸å½“äºä¸€ä¸ªè°ƒåº¦å‘˜èµ‹å€¼äº‹ä»¶çš„æ¥å—å’Œå‘å¸ƒï¼Œæ¯å½“æœ‰æ–°çš„ watcher å°±æ·»åŠ è¿›é˜Ÿåˆ—ï¼Œå½“æ•°æ®æ›´æ–°æ—¶ï¼Œç»Ÿä¸€é€šçŸ¥è¿™äº› watcher æˆ‘æ•°æ®æ›´æ–°å•¦ä½ ä¹Ÿå¿«æ›´æ–°å§ã€‚æœ‰äº†è°ƒåº¦å‘˜ï¼Œç°åœ¨ç¼ºä¸ªè®¢é˜…çš„æˆ‘ä»¬æ¥çœ‹ä¸‹ watcher æ€ä¹ˆå®ç°</p>
<h2 id="watcher">Watcher</h2>
<p>watcher å…¶å®å¾ˆç®€å•å°±åšä¸€ä»¶äº‹å¯¹èŠ‚ç‚¹çš„æ•°æ®è¿›è¡Œæ›´æ–°</p>
<pre><code class="language-js">class Watcher {
  constructor(node, type) {
    this.node = node; //ç›‘å¬çš„å­èŠ‚ç‚¹
    this.type = type; // å­èŠ‚ç‚¹ç±»å‹ï¼Œä¸åŒå­èŠ‚ç‚¹ç±»å‹èµ‹å€¼æ–¹å¼ä¸åŒ
  }
  update(value) {
    if (this.type == 'input') {
      this.node.value = value;
    }
    if (this.type == 'text') {
      this.node.nodeValue = value;
    }
  }
}
</code></pre>
<p>ç°åœ¨æœ‰äº† watcher,å’Œ dispatcher æˆ‘ä»¬åœ¨å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒçš„æ—¶å€™åœ¨ set get ä¸­è¿›è¡Œäº‹ä»¶çš„å‘å¸ƒå’Œè®¢é˜…</p>
<pre><code class="language-js">    definedRective(root, key, value) {
        if (typeof value == 'object') {
            this.observe(value, value)
        }
        const dep = new Dispatcher();//äº‹ä»¶æ´¾å‘è€…
        Object.defineProperty(root, key, {
            set(newVal) {
                if (value == newVal) return //å¦‚æœæ•°æ®æ²¡æ”¹å˜å°±ç›´æ¥è¿”å›
                value = newVal // è®°å½•æ”¹å˜çš„å€¼
                dep.notify(newVal) //å‘å¸ƒäº‹ä»¶
            },
            get() {
                console.log('get', value)
                dep.add(this.target) //æ·»åŠ è®¢é˜…è€…
                return value
            }
        })
    }
</code></pre>
<p>æœ€åå®ç° complie å¯¹ v-model ç­‰æŒ‡ä»¤è¿›è¡Œè§£æï¼Œå¹¶æ–°å»ºè®¢é˜…è€…</p>
<pre><code class="language-js">    compile(element) {
        const childNodes = element.childNodes;//è·å–æ‰€æœ‰å­èŠ‚ç‚¹
        for (let node of childNodes) {
            if (node.nodeType == 1) {// nodetypeå±æ€§åœ¨æ–‡æœ«æœ€åä¼šé™„ä¸Šè§£é‡Šï¼Œè¿™é‡Œçš„1ä»£è¡¨æ™®é€šå…ƒç´ 
                const attrs = node.attributes;//è·å–æ‰€æœ‰èŠ‚ç‚¹å±æ€§
                for (let attr of attrs) {
                    if (attr.name == 'v-model') { //è§£æv-modelçš„æŒ‡ä»¤
                        const name = attr.value
                        node.addEventListener('input', (e) =&gt; {
                            this[name] = e.target.value //ç›‘å¬æ•°æ®inputæ•°æ®æ”¹å˜
                        })
                        this.target = new Watcher(node, 'input')
                        this[name] //è§¦å‘åŠ«æŒæ·»åŠ ç›‘å¬,ä¸€å®šè¦å†™è¿™ä¸€å¥ï¼Œå› ä¸ºè¿™å¥å…¶å®å°±æ˜¯è·å–dataé‡Œé¢çš„å€¼ï¼Œä¸€æ—¦è·å–dataçš„å€¼å°±ä¼šè§¦å‘get å°†è®¢é˜…è€…æ·»åŠ è¿›è®¢é˜…è€…é›†åˆ
                    }
                    if (attr.name == '@click') {
                        const name = attr.value
                        node.addEventListener('click', this.methods[name].bind(this))
                    }
                }
            }
            if (node.nodeType == 3) {//nodeTypeç­‰äº3è¡¨ç¤ºæ–‡æœ¬å…ƒç´ 
                const reg = /\{\{(.*)\}\}/
                const match = node.nodeValue.match(reg)
                if (match) {
                    const name = match[1].trim()
                    this.target = new Watcher(node, 'text')
                    node.nodeValue = this.data[name]
                    this[name] //è§¦å‘åŠ«æŒæ·»åŠ ç›‘å¬
                }
            }
        }
    }
</code></pre>
<h2 id="nodetype-å±æ€§">nodetype å±æ€§</h2>
<figure data-type="image" tabindex="1"><img src="https://user-images.githubusercontent.com/44893721/55458438-9d077f80-561f-11e9-96c0-1e9948093bea.jpg" alt="1554273976(1)" loading="lazy"></figure>
]]></content>
    </entry>
</feed>